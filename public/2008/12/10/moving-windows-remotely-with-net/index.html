<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Moving Windows remotely with .NET &middot; </title>
        <meta name="description" content="A colleague of mine has a dual-monitor windows system.
Unfortunately he has a different monitor setup for home and work (work – 2nd monitor on the left; home – 2nd monitor on the right). Now when you work with certain Java applications which save their position on their own you come to the point where an window pops up out of the viewing range.
Now you have nearly now way to move that window, because you can’t click it.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.80.0" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Moving Windows remotely with .NET">
<meta property="og:description" content="A colleague of mine has a dual-monitor windows system.
Unfortunately he has a different monitor setup for home and work (work – 2nd monitor on the left; home – 2nd monitor on the right). Now when you work with certain Java applications which save their position on their own you come to the point where an window pops up out of the viewing range.
Now you have nearly now way to move that window, because you can’t click it.">
<meta property="og:type" content="article">
<meta property="og:url" content="/2008/12/10/moving-windows-remotely-with-net/">
        <link rel="stylesheet" href="/dist/site.css">
        <link rel="stylesheet" href="/dist/syntax.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
        
        
        

    </head>
    <body>
        
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-5676095-8', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a href="/">My personal blog</a>
                            </h1>
                        
                        
                            <a class="button-square" href="/index.xml" aria-label="RSS"><i class="fa fa-rss" aria-hidden="true"></i></a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" aria-label="Twitter" href="https://twitter.com/jens_walter" rel="me" >
                                <i class="fa fa-twitter" aria-hidden="true"></i>
                            </a>
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" aria-label="Github" href="https://github.com/JensWalter" rel="me">
                                <i class="fa fa-github-alt" aria-hidden="true"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Stack Overflow" aria-label="Stack Overflow" href="https://stackoverflow.com/users/story/220219" rel="me">
                                <i class="fa fa-stack-overflow" aria-hidden="true"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" aria-label="Send an Email" href="mailto:jens@apimeister.com">
                                <i class="fa fa-envelope" aria-hidden="true"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a href="/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a href="/project/">Projects</a>
    </li>


                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Moving Windows remotely with .NET</h1>
    
    <p class="post-date post-line">
        <span>Published <time datetime="2008-12-10" itemprop="datePublished">Wed, Dec 10, 2008</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="#" itemprop="url" rel="author"></a>
            </span>
        </span>
    </p>
    
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <p>A colleague of mine has a dual-monitor windows system.</p>
<p>Unfortunately he has a different monitor setup for home and work (work – 2nd monitor on the left; home – 2nd monitor on the right). Now when you work with certain Java applications which save their position on their own you come to the point where an window pops up out of the viewing range.</p>
<p>Now you have nearly now way to move that window, because you can’t click it. Moving over the task bar doesn’t work either. So I wrote a simple Application which can move the lost window back into the viewing range.</p>
<p>Here a bit out of the c# code:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75af00">[ DllImport(&#34;user32.dll&#34;) ]</span>
<span style="color:#00a8c8">static</span> <span style="color:#00a8c8">extern</span> <span style="color:#111">IntPtr</span> <span style="color:#111">GetForegroundWindow</span><span style="color:#111">();</span>
<span style="color:#75af00">
</span><span style="color:#75af00">[DllImportAttribute(&#34;user32.dll&#34;)]</span>
<span style="color:#75af00">[return: MarshalAs(UnmanagedType.Bool)]</span>
<span style="color:#00a8c8">static</span> <span style="color:#00a8c8">extern</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">GetWindowRect</span><span style="color:#111">(</span><span style="color:#111">IntPtr</span> <span style="color:#111">hWnd</span><span style="color:#111">,</span> <span style="color:#00a8c8">out</span> <span style="color:#111">RECT</span> <span style="color:#111">lpRect</span><span style="color:#111">);</span>
<span style="color:#75af00">
</span><span style="color:#75af00">[DllImport(&#34;user32.dll&#34;, ExactSpelling = true, CharSet = System.Runtime.InteropServices.CharSet.Auto)]</span>
<span style="color:#00a8c8">private</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">extern</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">MoveWindow</span><span style="color:#111">(</span><span style="color:#111">IntPtr</span> <span style="color:#111">hWnd</span><span style="color:#111">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">x</span><span style="color:#111">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">y</span><span style="color:#111">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">cx</span><span style="color:#111">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">cy</span><span style="color:#111">,</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">repaint</span><span style="color:#111">);</span>

<span style="color:#111">...</span>
<span style="color:#00a8c8">private</span> <span style="color:#00a8c8">void</span> <span style="color:#111">timer1_Tick</span><span style="color:#111">(</span><span style="color:#00a8c8">object</span> <span style="color:#111">sender</span><span style="color:#111">,</span> <span style="color:#111">System</span><span style="color:#111">.</span><span style="color:#111">EventArgs</span> <span style="color:#111">e</span><span style="color:#111">)</span>
<span style="color:#111">{</span>
	<span style="color:#111">IntPtr</span> <span style="color:#111">temp</span>  <span style="color:#111">=</span> <span style="color:#111">GetForegroundWindow</span><span style="color:#111">();</span>
	<span style="color:#00a8c8">if</span><span style="color:#111">(</span> <span style="color:#111">me</span> <span style="color:#111">!=</span> <span style="color:#111">temp</span><span style="color:#111">)</span>
	<span style="color:#111">{</span>
		<span style="color:#111">window</span> <span style="color:#111">=</span> <span style="color:#111">temp</span><span style="color:#111">;</span>
		<span style="color:#111">label1</span><span style="color:#111">.</span><span style="color:#111">Text</span> <span style="color:#111">=</span> <span style="color:#111">window</span><span style="color:#111">.</span><span style="color:#111">ToString</span><span style="color:#111">();</span>
			<span style="color:#111">RECT</span> <span style="color:#111">t</span> <span style="color:#111">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">RECT</span><span style="color:#111">();</span>
		<span style="color:#00a8c8">bool</span> <span style="color:#111">r</span> <span style="color:#111">=</span> <span style="color:#111">GetWindowRect</span><span style="color:#111">(</span><span style="color:#111">window</span><span style="color:#111">,</span> <span style="color:#00a8c8">out</span> <span style="color:#111">t</span><span style="color:#111">);</span>

		<span style="color:#111">posx</span> <span style="color:#111">=</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Location</span><span style="color:#111">.</span><span style="color:#111">X</span><span style="color:#111">;</span>
		<span style="color:#111">posy</span> <span style="color:#111">=</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Location</span><span style="color:#111">.</span><span style="color:#111">Y</span><span style="color:#111">;</span>
		<span style="color:#111">sizex</span> <span style="color:#111">=</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Width</span><span style="color:#111">;</span>
		<span style="color:#111">sizey</span> <span style="color:#111">=</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Height</span><span style="color:#111">;</span>
		<span style="color:#111">label1</span><span style="color:#111">.</span><span style="color:#111">Text</span> <span style="color:#111">=</span> <span style="color:#111">label1</span><span style="color:#111">.</span><span style="color:#111">Text</span> <span style="color:#111">+</span> <span style="color:#d88200">&#34;\nx: &#34;</span>  <span style="color:#111">+</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Location</span><span style="color:#111">.</span><span style="color:#111">X</span><span style="color:#111">+</span> <span style="color:#d88200">&#34;\ny: &#34;</span> <span style="color:#111">+</span> <span style="color:#111">t</span><span style="color:#111">.</span><span style="color:#111">Location</span><span style="color:#111">.</span><span style="color:#111">Y</span>
				<span style="color:#111">+</span><span style="color:#d88200">&#34;\nwidth: &#34;</span><span style="color:#111">+</span><span style="color:#111">sizex</span> <span style="color:#111">+</span> <span style="color:#d88200">&#34;\nheight: &#34;</span> <span style="color:#111">+</span> <span style="color:#111">sizey</span><span style="color:#111">;</span>
		<span style="color:#111">}</span>
	<span style="color:#111">}</span>

<span style="color:#00a8c8">private</span> <span style="color:#00a8c8">void</span> <span style="color:#111">button2_Click</span><span style="color:#111">(</span><span style="color:#00a8c8">object</span> <span style="color:#111">sender</span><span style="color:#111">,</span> <span style="color:#111">System</span><span style="color:#111">.</span><span style="color:#111">EventArgs</span> <span style="color:#111">e</span><span style="color:#111">)</span>
<span style="color:#111">{</span>
	<span style="color:#75715e">//right
</span><span style="color:#75715e"></span>	<span style="color:#111">posx</span> <span style="color:#111">=</span> <span style="color:#111">posx</span> <span style="color:#111">+</span><span style="color:#ae81ff">10</span><span style="color:#111">;</span>
	<span style="color:#111">MoveWindow</span><span style="color:#111">((</span><span style="color:#111">IntPtr</span><span style="color:#111">)</span><span style="color:#111">window</span><span style="color:#111">,</span> <span style="color:#111">posx</span><span style="color:#111">,</span> <span style="color:#111">posy</span> <span style="color:#111">,</span> <span style="color:#111">sizex</span><span style="color:#111">,</span> <span style="color:#111">sizey</span><span style="color:#111">,</span> <span style="color:#00a8c8">true</span><span style="color:#111">);</span>
<span style="color:#111">}</span>
</code></pre></div><p>This is just to get a basic idea what I’ve done here. You can also look at the complete source code yourself (vs2003 project is attached) or just use the application as is (although it is pretty ugly – more like a proof of concept.</p>
<p>downloads:</p>
<ul>
<li><a href="/assets/windowsapplication1.exe">windowsapplication1.exe</a></li>
<li><a href="/assets/windowsapplication1.zip">windowsapplication1 project folder</a></li>
</ul>
<p><a href="/2009/02/01/moving-windows-part2.html" title="follow-up here">follow-up here</a></p>

</div>

        <footer class="post-footer clearfix">
        <p class="post-tags">
            <span>Tagged:</span>
                <a href="/tags/csharp/">csharp</a>
        </p>
    <div class="share">
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a href="/">My personal blog</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#" aria-label="Back to Top">
                        <i class="fa fa-angle-up" aria-hidden="true"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2021 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="/js/jquery-1.11.3.min.js"></script>
        <script src="/js/jquery.fitvids.js"></script>
        <script src="/js/scripts.js"></script>
    </body>
</html>

